# Locomo æ•°æ®é›†åŒè§†è§’è¯„æµ‹æœºåˆ¶

## ğŸ“– æ¦‚è¿°

æœ¬æ¨¡å—å®ç°äº†ç±»ä¼¼ Mem0 è¯„æµ‹é¡¹ç›®çš„**åŒè§†è§’è®°å¿†æœºåˆ¶**ï¼Œç”¨äºåœ¨ Locomo æ•°æ®é›†ä¸Šè¯„æµ‹ TinyMem0 è®°å¿†ç³»ç»Ÿã€‚

## ğŸ¯ æ ¸å¿ƒæ€æƒ³

### é—®é¢˜
Locomo æ•°æ®é›†æ˜¯**ä¸¤äººå¯¹è¯**ï¼ˆå¦‚ Caroline å’Œ Melanieï¼‰ï¼Œä½† LLM è®°å¿†ç³»ç»Ÿæ˜¯**ç”¨æˆ·-ç³»ç»Ÿ**æ¨¡å¼ã€‚å¦‚ä½•é€‚é…ï¼Ÿ

### è§£å†³æ–¹æ¡ˆï¼šè§†è§’è½¬æ¢

ä¸ºåŒä¸€æ®µå¯¹è¯åˆ›å»º**ä¸¤ä¸ªç‹¬ç«‹çš„è®°å¿†åº“**ï¼Œé€šè¿‡è§†è§’è½¬æ¢è®©æ¯ä¸ªäººéƒ½æˆä¸º"ç”¨æˆ·"ï¼š

```
åŸå§‹å¯¹è¯:
D1:1 Caroline: "Hey Mel! Good to see you!"
D1:2 Melanie: "I'm swamped with the kids."
D1:3 Caroline: "I went to a LGBTQ support group yesterday."

                    â†“ è§†è§’è½¬æ¢
                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Caroline çš„è®°å¿†åº“ (user_id: Caroline_0)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ user: Caroline: Hey Mel! Good to see you!       â”‚
â”‚ assistant: Melanie: I'm swamped with the kids.  â”‚
â”‚ user: Caroline: I went to LGBTQ support group.  â”‚
â”‚                                                 â”‚
â”‚ æå–äº‹å®ï¼ˆåªä» user æ¶ˆæ¯ï¼‰:                        â”‚
â”‚  â†’ "Caroline went to LGBTQ support group"       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Melanie çš„è®°å¿†åº“ (user_id: Melanie_0)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ assistant: Caroline: Hey Mel! Good to see you!  â”‚
â”‚ user: Melanie: I'm swamped with the kids.       â”‚
â”‚ assistant: Caroline: I went to LGBTQ support... â”‚
â”‚                                                 â”‚
â”‚ æå–äº‹å®ï¼ˆåªä» user æ¶ˆæ¯ï¼‰:                        â”‚
â”‚  â†’ "Melanie is swamped with kids and work"      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ æ–‡ä»¶ç»“æ„

```
utils/evaluation/
â”œâ”€â”€ locomo_adapter.py       # æ ¸å¿ƒé€‚é…å™¨
â””â”€â”€ __init__.py

examples/
â””â”€â”€ locomo_evaluation.py    # è¯„æµ‹ç¤ºä¾‹è„šæœ¬
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å• Session è¯„æµ‹

```bash
python examples/locomo_evaluation.py --mode single
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
Locomo è¯„æµ‹ç¤ºä¾‹ï¼šå• Session åŒè§†è§’è®°å¿†
======================================================================

æ­¥éª¤1: åŠ è½½ Locomo æ•°æ®é›†
----------------------------------------------------------------------
âœ… åŠ è½½ 1 ä¸ªå¯¹è¯åœºæ™¯

å¯¹è¯åœºæ™¯ 0:
  Speaker A: Caroline
  Speaker B: Melanie

æ­¥éª¤2: æå– Session 1 å¯¹è¯
----------------------------------------------------------------------
Session 1 (1:56 pm on 8 May, 2023)
  å…± 18 æ¡æ¶ˆæ¯

æ­¥éª¤3: åŒè§†è§’è½¬æ¢
----------------------------------------------------------------------
âœ… è½¬æ¢å®Œæˆ:
  Caroline è§†è§’: 18 æ¡æ¶ˆæ¯ (user_id: Caroline_0)
  Melanie è§†è§’: 18 æ¡æ¶ˆæ¯ (user_id: Melanie_0)

æ­¥éª¤4: åˆå§‹åŒ–åŒè®°å¿†åº“
----------------------------------------------------------------------
âœ… Caroline çš„è®°å¿†åº“åˆå§‹åŒ–å®Œæˆ
âœ… Melanie çš„è®°å¿†åº“åˆå§‹åŒ–å®Œæˆ

æ­¥éª¤5: å†™å…¥åŒè§†è§’è®°å¿†
----------------------------------------------------------------------
æ­£åœ¨å†™å…¥ Caroline çš„è®°å¿†...
âœ… Caroline è®°å¿†å†™å…¥å®Œæˆ

æ­£åœ¨å†™å…¥ Melanie çš„è®°å¿†...
âœ… Melanie è®°å¿†å†™å…¥å®Œæˆ

æ­¥éª¤6: æœç´¢éªŒè¯è®°å¿†
----------------------------------------------------------------------

ğŸ” æŸ¥è¯¢1: Caroline å»äº†å“ªé‡Œï¼Ÿ

  æœç´¢ç»“æœ (3 æ¡):
    1. Caroline went to LGBTQ support group yesterday...
       (åˆ†æ•°: 0.856)

ğŸ” æŸ¥è¯¢2: Melanie åœ¨å¿™ä»€ä¹ˆï¼Ÿ

  æœç´¢ç»“æœ (3 æ¡):
    1. Melanie is swamped with kids and work...
       (åˆ†æ•°: 0.892)

======================================================================
âœ… è¯„æµ‹å®Œæˆ
```

### 2. å¤š Session è¯„æµ‹

```bash
python examples/locomo_evaluation.py --mode multi
```

å¤„ç†è¿ç»­çš„å¤šä¸ª sessionï¼Œæµ‹è¯•è®°å¿†ç´¯ç§¯æ•ˆæœã€‚

## ğŸ”§ API ä½¿ç”¨

### LocomoAdapter

```python
from utils.evaluation.locomo_adapter import LocomoAdapter

# 1. åˆå§‹åŒ–
adapter = LocomoAdapter('locomo/data/locomo1.json')

# 2. è·å–å¯¹è¯
conversation_data = adapter.get_conversation_pair(idx=0)
conversation = conversation_data['conversation']

# 3. æå– session
speaker_a, speaker_b, dialogs = adapter.get_session_dialogs(
    conversation, session_num=1
)

# 4. è§†è§’è½¬æ¢ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰
user_id_a, messages_a, user_id_b, messages_b = adapter.convert_to_dual_perspective(
    speaker_a, speaker_b, dialogs, conversation_idx=0
)

# 5. æ ¼å¼åŒ–ä¸ºè®°å¿†ç³»ç»Ÿè¾“å…¥
conversation_text = adapter.format_for_memory_system(messages_a)

# 6. å†™å…¥è®°å¿†
memory_system.write_memory(
    conversation=conversation_text,
    user_id=user_id_a,
    agent_id="assistant"
)
```

## ğŸ“Š è§†è§’è½¬æ¢è§„åˆ™

| åŸå§‹å¯¹è¯ | Caroline è§†è§’ | Melanie è§†è§’ |
|---------|--------------|--------------|
| Caroline è¯´è¯ | `role: user` âœ… ä¼šè¢«è®°å¿† | `role: assistant` âŒ ä¸ä¼šè¢«è®°å¿† |
| Melanie è¯´è¯ | `role: assistant` âŒ ä¸ä¼šè¢«è®°å¿† | `role: user` âœ… ä¼šè¢«è®°å¿† |

**å…³é”®ç‚¹**ï¼š
- è®°å¿†ç³»ç»Ÿ**åªä» `user` æ¶ˆæ¯ä¸­æå–äº‹å®**
- é€šè¿‡è§†è§’è½¬æ¢ï¼Œè®©ä¸¤ä¸ªäººéƒ½èƒ½ä»¥"ç”¨æˆ·"èº«ä»½è®°å½•è‡ªå·±çš„ä¿¡æ¯
- ä¿ç•™è¯´è¯è€…åå­—ï¼ˆå¦‚ `"Caroline: text"`ï¼‰ï¼Œæ–¹ä¾¿ LLM æå–æ—¶è¯†åˆ«ä¸»ä½“

## ğŸ”¬ è¯„æµ‹æŒ‡æ ‡

å¯ä»¥åŸºäº Locomo æ•°æ®é›†çš„ QA å¯¹è¿›è¡Œè¯„æµ‹ï¼š

1. **å¬å›ç‡**ï¼šèƒ½å¦ä»è®°å¿†ä¸­æ‰¾åˆ°ç­”æ¡ˆç›¸å…³çš„ä¿¡æ¯
2. **å‡†ç¡®æ€§**ï¼šæå–çš„äº‹å®æ˜¯å¦æ­£ç¡®
3. **æ—¶åºæ€§**ï¼šå¤š session æ˜¯å¦ä¿æŒæ—¶é—´é¡ºåº
4. **éš”ç¦»æ€§**ï¼šä¸¤ä¸ªè®°å¿†åº“æ˜¯å¦æ­£ç¡®éš”ç¦»

## ğŸ“ å‚è€ƒ

æœ¬å®ç°å‚è€ƒäº† Mem0 è¯„æµ‹é¡¹ç›®çš„è®¾è®¡ï¼š
- [Mem0 GitHub](https://github.com/mem0ai/mem0)
- æ ¸å¿ƒæ€æƒ³ï¼šè§†è§’è½¬æ¢ï¼ˆPerspective Swapï¼‰
- è¾“å…¥æ ¼å¼ï¼š`{"role": "user/assistant", "content": "{Name}: {text}"}`

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **user_id å‘½å**ï¼šä½¿ç”¨ `{speaker_name}_{conversation_idx}` æ ¼å¼ï¼Œç¡®ä¿å”¯ä¸€æ€§
2. **æ¶ˆæ¯æ ¼å¼**ï¼šä¿ç•™è¯´è¯è€…åå­—ï¼Œæ ¼å¼ä¸º `{role}: {Speaker}: {text}`
3. **è®°å¿†åº“éš”ç¦»**ï¼šä¸¤ä¸ª speaker ä½¿ç”¨ä¸åŒçš„ `collection_name`
4. **äº‹å®æå–**ï¼šåªä» `user` è§’è‰²çš„æ¶ˆæ¯ä¸­æå–ï¼Œè¿™æ˜¯ Mem0 çš„è®¾è®¡åŸåˆ™
